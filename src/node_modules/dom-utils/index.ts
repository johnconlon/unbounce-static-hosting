export function ready(fn: Function) {
  if (
    (document as any).attachEvent
      ? document.readyState === "complete"
      : document.readyState !== "loading"
  ) {
    fn();
  } else {
    document.addEventListener("DOMContentLoaded", fn as EventListener);
  }
}

export function getUrlParameter(name: string) {
  name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
  var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
  var results = regex.exec(location.search);
  return results === null
    ? ""
    : decodeURIComponent(results[1].replace(/\+/g, " "));
}

export function getUrlParams() {
  var pageUrl = decodeURIComponent(window.location.search.substring(1));
  var urlParams = pageUrl.split("&");
  var params: { [k: string]: any } = {};
  for (var i = 0; i < urlParams.length; i++) {
    var urlParam = urlParams[i].split("=");
    params[urlParam[0]] = urlParam[1] && urlParam[1].replace(/\+|%20/g, " ");
  }
  return params;
}

export function enableAnchorScrollEffect() {
  ready(() => {
    const speed = 400;
    // Find links that are #anchors and scroll to them
    $("a[href^=#]")
      .not(".lp-pom-form .lp-pom-button")
      .unbind("click.smoothScroll")
      .bind("click.smoothScroll", function(event) {
        event.preventDefault();
        $("html, body").animate(
          { scrollTop: $($(this).attr("href")!).offset()!.top },
          speed
        );
      });
  });
}
